theme(axis.title.x = element_text(size=18, face="bold"),
axis.title.y = element_text(size=18, face="bold"), axis.text.x = element_text(size=18), axis.text.y = element_text(size=18))
ggsave(filename = "/Users/matt/Desktop/d_bnd.svg", plot = fig2)
fig3 <- ggplot(data, aes(x=ebr1_K2P, y=mean_D)) +
geom_point(size = 3) +
labs(x="EBR1 Distance (K2P)", y = "Mean Patterson's D Statistic") +
theme_classic() +
theme(axis.title.x = element_text(size=18, face="bold"),
axis.title.y = element_text(size=18, face="bold"), axis.text.x = element_text(size=18), axis.text.y = element_text(size=18))
ggsave(filename = "/Users/matt/Desktop/d_ebr1.svg", plot = fig3)
data <- read.csv("/Users/matt/Documents/GitHub/urchin_grp/hdock/bindin/overlap_dist.csv", header = FALSE)
# Convert the data to a vector
data_vector <- as.vector(unlist(data))
mean(data_vector)
model1 <- lm(data_vector ~ 1)
confint(model1, level=0.99)
# Read the file
data <- read.csv("/Users/matt/Documents/GitHub/urchin_grp/hdock/bindin/overlap_dist.csv", header = FALSE)
# Convert the data to a vector
data_vector <- as.vector(unlist(data))
mean(data_vector)
model1 <- lm(data_vector ~ 1)
confint(model1, level=0.99)
# Read the file
data <- read.csv("/Users/matt/Documents/GitHub/urchin_grp/hdock/bindin/overlap_dist.csv", header = FALSE)
# Convert the data to a vector
data_vector <- as.vector(unlist(data))
mean(data_vector)
model1 <- lm(data_vector ~ 1)
confint(model1, level=0.99)
# Read the file
data <- read.csv("/Users/matt/Documents/GitHub/urchin_grp/hdock/ebr1/overlap_dist.csv", header = FALSE)
# Convert the data to a vector
data_vector <- as.vector(unlist(data))
mean(data_vector)
model1 <- lm(data_vector ~ 1)
confint(model1, level=0.99)
# Read the file
data <- read.csv("/Users/matt/Documents/GitHub/urchin_grp/hdock/ebr1/overlap_dist.csv", header = FALSE)
# Convert the data to a vector
data_vector <- as.vector(unlist(data))
mean(data_vector)
model1 <- lm(data_vector ~ 1)
confint(model1, level=0.99)
# Read the file
data <- read.csv("/Users/matt/Documents/GitHub/urchin_grp/hdock/ebr1/overlap_dist.csv", header = FALSE)
# Convert the data to a vector
data_vector <- as.vector(unlist(data))
mean(data_vector)
model1 <- lm(data_vector ~ 1)
confint(model1, level=0.99)
# Read the file
data <- read.csv("/Users/matt/Documents/GitHub/urchin_grp/hdock/ebr1/overlap_dist.csv", header = FALSE)
# Convert the data to a vector
data_vector <- as.vector(unlist(data))
mean(data_vector)
model1 <- lm(data_vector ~ 1)
confint(model1, level=0.99)
# Read the file
data <- read.csv("/Users/matt/Documents/GitHub/urchin_grp/hdock/ebr1/overlap_dist.csv", header = FALSE)
# Convert the data to a vector
data_vector <- as.vector(unlist(data))
mean(data_vector)
model1 <- lm(data_vector ~ 1)
confint(model1, level=0.99)
library(rsconnect)
renv::snapshot()
library(rsconnect)
renv::snapshot()
rsconnect::deployApp('/Users/matt/Documents/GitHub/hla_coverage/scripts/shiny_app/', appName = "hla_coverage")
install.packages("devtools", dependencies = TRUE)
library(devtools)
library(devtools)
devtools::install_github("JTNelsonWSU/COMICS", build_vignettes = FALSE)
#devtools::install_github("JTNelsonWSU/COMICS", build_vignettes = FALSE)
library(COMICS)
launchApp()
install.packages("ICS")
library(devtools)
#devtools::install_github("JTNelsonWSU/COMICS", build_vignettes = FALSE)
library(COMICS)
launchApp()
install.packages("moments")
library(devtools)
#devtools::install_github("JTNelsonWSU/COMICS", build_vignettes = FALSE)
library(COMICS)
launchApp()
install.packages("‘ICSOutlier’")
install.packages("ICSOutlier")
library(devtools)
#devtools::install_github("JTNelsonWSU/COMICS", build_vignettes = FALSE)
library(COMICS)
launchApp()
install.packages(c("shiny", "ggplot2", "tidyr", "bslib", "mvtnorm", "ICS", "moments", "ICSOutlier"), dependencies = TRUE)
install.packages(c("shiny", "ggplot2", "tidyr", "bslib", "mvtnorm", "ICS", "moments", "ICSOutlier"), dependencies = TRUE)
install.packages(c("shiny", "ggplot2", "tidyr", "bslib", "mvtnorm", "ICS", "moments", "ICSOutlier"), dependencies = TRUE)
install.packages(c("shiny", "ggplot2", "tidyr", "bslib", "mvtnorm", "ICS", "moments", "ICSOutlier"), dependencies = TRUE)
library(devtools)
#devtools::install_github("JTNelsonWSU/COMICS", build_vignettes = FALSE)
library(COMICS)
launchApp()
install.packages("shinythemes")
library(devtools)
#devtools::install_github("JTNelsonWSU/COMICS", build_vignettes = FALSE)
library(COMICS)
launchApp()
library(devtools)
#devtools::install_github("JTNelsonWSU/COMICS", build_vignettes = FALSE)
library(COMICS)
launchApp()
library(devtools)
#devtools::install_github("JTNelsonWSU/COMICS", build_vignettes = FALSE)
library(COMICS)
launchApp()
remove.packages("COMICS")
install.packages(c("shiny", "ggplot2", "tidyr", "bslib", "mvtnorm", "ICS", "moments", "ICSOutlier"), dependencies = TRUE)
install.packages(c("shiny", "ggplot2", "tidyr", "bslib", "mvtnorm", "ICS", "moments", "ICSOutlier"), dependencies = TRUE)
install.packages("devtools", dependencies = TRUE)
devtools::install_github("oeco28/new_COMICS", build_vignettes = FALSE)
library(COMICS)
library(devtools)
library(COMICS)
run_comics()
library(ggplot2)
library(ggrepel)
library(dplyr)
# Create a simple data frame of steps and coordinates
workflow_steps <- data.frame(
step = c(
"Demultiplexing\n(Dorado / Lima)",
"Adapter Removal\n(Porechop_ABI / Lima)",
"Quality Trimming\n(Prowler)",
"Mapping to Reference\n(minimap2)",
"Quality Control\n(Retain Primary Alignments)\n(Exclude Duplicates)",
"Variant Calling\n(DeepVariant + pbsv + pbtrgt / Clair3 + Sniffles)",
"Phasing\n(HiPhase / LongPhase)",
"FASTA Generation\n(HLA Pipeline)"
),
x = 1:8,
y = rep(0, 8)
)
# Arrows: Create a separate data frame for segment coordinates
arrows <- data.frame(
x = 1:7,
xend = 2:8,
y = rep(0, 7),
yend = rep(0, 7)
)
# Make the plot
p <- ggplot() +
geom_text(data = workflow_steps, aes(x = x, y = y, label = step),
size = 4, fontface = "bold", lineheight = 0.9, vjust = -1) +
geom_segment(data = arrows, aes(x = x, xend = xend, y = y, yend = yend),
arrow = arrow(length = unit(0.25, "cm")), size = 0.8) +
xlim(0.5, 8.5) +
ylim(-0.5, 1.5) +
theme_void() +
theme(
plot.margin = margin(20, 20, 20, 20),
plot.title = element_text(hjust = 0.5, face = "bold", size = 16)
) +
ggtitle("HLA Haplotyping Workflow (ONT and PacBio)")
print(p)
x <- c(557769, 401179, 283210, 226171, 445841, 459239, 476, 375793, 316964, 274918,
243427, 113398, 167798, 465662, 380881, 458999, 186484, 253825, 506101,
145668, 610765, 97855, 888715, 502864, 244379, 372735, 442819, 467481,
42239, 245532, 789317, 81047, 292962)
y <- c(1212896, 942780, 614622, 397233, 797123, 741402, 3474, 629327, 564763, 450805,
759844, 193261, 392201, 1092009, 721164, 760718, 406359, 2000237, 4527533,
1144792, 5309266, 1170102, 5566497, 3995232, 2085419, 2572146, 3909344,
4435269, 868210, 2511645, 5731326, 1020007, 2470494)
data <- data.frame(x, y)
model <- lm(y ~ x, data = data)
summary(model)
plot(data$x, data$y, main="Linear Regression", xlab="X", ylab="Y", pch=19)
abline(model, col="red", lwd=2)
cor(x, y, method = "pearson")
cor(x, y, method = "spearman")
pacbio_hprc <- c(557769, 401179, 283210, 226171, 445841, 459239, 476, 375793, 316964, 274918, 243427, 113398, 167798, 465662, 380881, 458999, 186484)
pacbio_ihw <- c(253825, 506101, 145668, 610765, 97855, 888715, 502864, 244379, 372735, 442819, 467481, 42239, 245532, 789317, 81047, 292962)
ont_hprc <- c(1212896, 942780, 614622, 397233, 797123, 741402, 3474, 629327, 564763, 450805, 759844, 193261, 392201, 1092009, 721164, 760718, 406359)
ont_ihw <- c(2000237, 4527533, 1144792, 5309266, 1170102, 5566497, 3995232, 2085419, 2572146, 3909344, 4435269, 868210, 2511645, 5731326, 1020007, 2470494)
cor(pacbio_hprc, ont_hprc, method = "pearson")
cor(pacbio_ihw, ont_ihw, method = "spearman")
plot(x, y, col = c(rep("blue", length(pacbio_hprc)), rep("red", length(pacbio_ihw))), pch = 19)
abline(lm(ont_hprc ~ pacbio_hprc), col = "blue")
abline(lm(ont_ihw ~ pacbio_ihw), col = "red")
pacbio_hprc <- c(557769, 401179, 283210, 226171, 445841, 459239, 476, 375793, 316964, 274918, 243427, 113398, 167798, 465662, 380881, 458999, 186484)
pacbio_ihw <- c(253825, 506101, 145668, 610765, 97855, 888715, 502864, 244379, 372735, 442819, 467481, 42239, 245532, 789317, 81047, 292962)
ont_hprc <- c(1212896, 942780, 614622, 397233, 797123, 741402, 3474, 629327, 564763, 450805, 759844, 193261, 392201, 1092009, 721164, 760718, 406359)
ont_ihw <- c(2000237, 4527533, 1144792, 5309266, 1170102, 5566497, 3995232, 2085419, 2572146, 3909344, 4435269, 868210, 2511645, 5731326, 1020007, 2470494)
cor(pacbio_hprc, ont_hprc, method = "pearson")
cor(pacbio_ihw, ont_ihw, method = "pearson")
cor(pacbio_hprc, ont_hprc, method = "spearman")
cor(pacbio_ihw, ont_ihw, method = "spearman")
# Load necessary libraries
library(ggplot2)
library(tidyr)
library(dplyr)
# Set working directory
setwd("/Users/matt/Documents/GitHub/mhc/scripts/visualizations/concordance/")
# Read the CSV file
data <- read.csv("concordance_results.csv", header = TRUE, stringsAsFactors = FALSE)
head(data)
# Clean up the numeric columns (if necessary)
data$recall <- as.numeric(gsub("[^0-9.]", "", data$recall))
data$precision <- as.numeric(gsub("[^0-9.]", "", data$precision))
data$f1 <- as.numeric(gsub("[^0-9.]", "", data$f1))
# Rename 'type' and 'platform' variables directly
data$type[data$type == "snp"] <- "SNV"
data$type[data$type == "indel"] <- "Indel"
data$platform[data$platform == "revio"] <- "PacBio Revio"
data$platform[data$platform == "promethion"] <- "ONT PromethION"
# Reorder the levels of `type` and `platform`
data$type <- factor(data$type, levels = c("SNV", "Indel")) # SNV on top
data$platform <- factor(data$platform, levels = c("PacBio Revio", "ONT PromethION")) # PacBio Revio on left
# Reshape the data to long format
data_long <- data %>%
pivot_longer(cols = c(recall, precision, f1),
names_to = "metric",
values_to = "value")
# Standardize the names of `metric`
data_long$metric <- recode(data_long$metric,
recall = "Recall",
precision = "Precision",
f1 = "F1")  # Ensure consistent naming
# Define a color-blind-friendly palette
cb_palette <- c("Recall" = "#D55E00", "Precision" = "#0072B2", "F1" = "#009E73")
# Map specific shapes to each metric
shape_mapping <- c("Recall" = 17, "Precision" = 15, "F1" = 16) # Triangle, square, and circle
# Plot the data
figure <- ggplot(data_long, aes(x = sample, y = value, shape = metric, color = metric, group = metric)) +
geom_point(size = 3) +
facet_grid(type ~ platform, scales = "free_y") + # Facet using reordered variables
theme_bw() +
labs(
x = "Sample",
y = "Metric Value",
shape = "Metric",
color = "Metric"
) +
scale_shape_manual(values = shape_mapping) +
scale_color_manual(values = cb_palette) + # Apply color-blind-friendly palette
theme(
axis.text.x = element_text(hjust = 0.5),
strip.text = element_text(size = 12, face = "bold"),
legend.title = element_text(size = 12),
legend.text = element_text(size = 10)
)
# Display the plot
figure
# Load necessary libraries
library(ggplot2)
library(tidyr)
library(dplyr)
# Set working directory
setwd("/Users/matt/Documents/GitHub/mhc/scripts/visualizations/concordance/")
# Read the CSV file
data <- read.csv("concordance_results.csv", header = TRUE, stringsAsFactors = FALSE)
head(data)
# Clean up the numeric columns (if necessary)
data$recall <- as.numeric(gsub("[^0-9.]", "", data$recall))
data$precision <- as.numeric(gsub("[^0-9.]", "", data$precision))
data$f1 <- as.numeric(gsub("[^0-9.]", "", data$f1))
# Rename 'type' and 'platform' variables directly
data$type[data$type == "snp"] <- "SNV"
data$type[data$type == "indel"] <- "Indel"
data$platform[data$platform == "revio"] <- "PacBio Revio"
data$platform[data$platform == "promethion"] <- "ONT PromethION"
# Reorder the levels of `type` and `platform`
data$type <- factor(data$type, levels = c("SNV", "Indel")) # SNV on top
data$platform <- factor(data$platform, levels = c("PacBio Revio", "ONT PromethION")) # PacBio Revio on left
# Reshape the data to long format
data_long <- data %>%
pivot_longer(cols = c(recall, precision, f1),
names_to = "metric",
values_to = "value")
# Standardize the names of `metric`
data_long$metric <- recode(data_long$metric,
recall = "Recall",
precision = "Precision",
f1 = "F1")  # Ensure consistent naming
# Define a color-blind-friendly palette
cb_palette <- c("Recall" = "#D55E00", "Precision" = "#0072B2", "F1" = "#009E73")
# Map specific shapes to each metric
shape_mapping <- c("Recall" = 17, "Precision" = 15, "F1" = 16) # Triangle, square, and circle
# Plot the data
figure <- ggplot(data_long, aes(x = sample, y = value, shape = metric, color = metric, group = metric)) +
geom_point(size = 3) +
facet_grid(type ~ platform, scales = "free_y") + # Facet using reordered variables
theme_bw() +
labs(
x = "Sample",
y = "Metric Value",
shape = "Metric",
color = "Metric"
) +
scale_shape_manual(values = shape_mapping) +
scale_color_manual(values = cb_palette) + # Apply color-blind-friendly palette
theme(
axis.text.x = element_text(hjust = 0.5),
strip.text = element_text(size = 12, face = "bold"),
legend.title = element_text(size = 12),
legend.text = element_text(size = 10)
)
# Display the plot
figure
ggsave(filename = "concordance.pdf", plot = figure, width = 169, units = "mm")
figure <- ggplot(data_long, aes(x = sample, y = value, shape = metric, color = metric, group = metric)) +
geom_point(size = 3) +
facet_grid(type ~ platform, scales = "free_y") + # Facet using reordered variables
theme_bw() +
labs(
x = "Sample",
y = "Metric Value",
shape = "Metric",
color = "Metric"
) +
scale_shape_manual(values = shape_mapping) +
scale_color_manual(values = cb_palette) + # Apply color-blind-friendly palette
theme(
axis.text.x = element_text(hjust = 0.5),
strip.text = element_text(size = 12, face = "bold"),
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
legend.position = top
)
figure <- ggplot(data_long, aes(x = sample, y = value, shape = metric, color = metric, group = metric)) +
geom_point(size = 3) +
facet_grid(type ~ platform, scales = "free_y") + # Facet using reordered variables
theme_bw() +
labs(
x = "Sample",
y = "Metric Value",
shape = "Metric",
color = "Metric"
) +
scale_shape_manual(values = shape_mapping) +
scale_color_manual(values = cb_palette) + # Apply color-blind-friendly palette
theme(
axis.text.x = element_text(hjust = 0.5),
strip.text = element_text(size = 12, face = "bold"),
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
legend.position = "top"
)
# Display the plot
figure
ggsave(filename = "concordance.pdf", plot = figure)
ggsave(filename = "concordance.png", plot = figure)
# Load necessary libraries
library(ggplot2)
library(tidyr)
library(dplyr)
# Set working directory
setwd("/Users/matt/Documents/GitHub/mhc/scripts/visualizations/concordance/")
# Read the CSV file
data <- read.csv("concordance_results.csv", header = TRUE, stringsAsFactors = FALSE)
head(data)
# Clean up the numeric columns (if necessary)
data$recall <- as.numeric(gsub("[^0-9.]", "", data$recall))
data$precision <- as.numeric(gsub("[^0-9.]", "", data$precision))
data$f1 <- as.numeric(gsub("[^0-9.]", "", data$f1))
# Rename 'type' and 'platform' variables directly
data$type[data$type == "snp"] <- "SNV"
data$type[data$type == "indel"] <- "Indel"
data$platform[data$platform == "revio"] <- "PacBio Revio"
data$platform[data$platform == "promethion"] <- "ONT PromethION"
# Reorder the levels of `type` and `platform`
data$type <- factor(data$type, levels = c("SNV", "Indel")) # SNV on top
data$platform <- factor(data$platform, levels = c("PacBio Revio", "ONT PromethION")) # PacBio Revio on left
# Reshape the data to long format
data_long <- data %>%
pivot_longer(cols = c(recall, precision, f1),
names_to = "metric",
values_to = "value")
# Standardize the names of `metric`
data_long$metric <- recode(data_long$metric,
recall = "Recall",
precision = "Precision",
f1 = "F1")  # Ensure consistent naming
# Define a color-blind-friendly palette
cb_palette <- c("Recall" = "#D55E00", "Precision" = "#0072B2", "F1" = "#009E73")
# Map specific shapes to each metric
shape_mapping <- c("Recall" = 17, "Precision" = 15, "F1" = 16) # Triangle, square, and circle
# Plot the data
figure <- ggplot(data_long, aes(x = sample, y = value, shape = metric, color = metric, group = metric)) +
geom_point(size = 3) +
facet_grid(type ~ platform, scales = "free_y") + # Facet using reordered variables
theme_bw() +
labs(
x = "Sample",
y = "Metric Value",
shape = "Metric",
color = "Metric"
) +
scale_shape_manual(values = shape_mapping) +
scale_color_manual(values = cb_palette) + # Apply color-blind-friendly palette
theme(
axis.text.x = element_text(hjust = 0.5),
strip.text = element_text(size = 12, face = "bold"),
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
legend.position = "top"
)
# Display the plot
figure
ggsave(filename = "concordance.png", plot = figure)
library(tidyr)
library(ggplot2)
library(viridis)
setwd("/Users/matt/Documents/GitHub/mhc/scripts/visualizations/heat_map/")
# Read the data
#data <- read.table("pacbio_genes.txt", header = TRUE, sep = "\t", stringsAsFactors = FALSE)
#data <- read.table("revio_gene_coverage_depth.tsv", header = TRUE, sep = "\t", stringsAsFactors = FALSE)
data <- read.table("promethion_gene_coverage_depth.tsv", header = TRUE, sep = "\t", stringsAsFactors = FALSE)
# Handle duplicate gene names
rownames(data) <- make.unique(data[, 1])  # Ensure unique gene names
gene_order <- rownames(data)              # Store the original gene order
data <- data[, -1]                        # Remove the first column (gene names)
# Transpose the data so genes are columns and samples are rows
heatmap_data <- t(as.matrix(data))        # Transpose the matrix
heatmap_data[heatmap_data > 50] <- 50
sample_order <- rev(rownames(heatmap_data))  # Reverse the sample order
# Convert to a data frame for ggplot
df <- as.data.frame(heatmap_data)
df$Sample <- rownames(heatmap_data)       # Add sample names as a column
# Pivot to long format for ggplot
df_long <- pivot_longer(
df,
cols = -Sample,                  # All columns except "Sample"
names_to = "Gene",               # Gene names
values_to = "Depth"              # Depth values
)
# Ensure Samples and Genes retain their original order
df_long$Sample <- factor(df_long$Sample, levels = sample_order)  # Reverse sample order
df_long$Gene <- factor(df_long$Gene, levels = gene_order)
# Plot the heatmap with right-aligned gene labels
figure <- ggplot(df_long, aes(x = Gene, y = Sample, fill = Depth)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "white", high = "red") +
theme_minimal() +
theme(
axis.text.x = element_text(size = 5, angle = 90, hjust = 1, vjust = 0.5),  # Right-align x-axis labels
axis.ticks.x = element_blank(),                               # Remove x-axis ticks
axis.text.y = element_text(size = 7),                        # Adjust y-axis text size
panel.grid = element_blank(),                                 # Remove gridlines
legend.title = element_text(size = 10),                       # Adjust legend title size
legend.text = element_text(size = 10)                         # Adjust legend text size
) +
labs(
x = "MHC Genes",                  # Label for x-axis
y = "Samples",                    # Label for y-axis
fill = "Mean\nCoverage\nDepth"    # Legend title
) +
scale_x_discrete(labels = levels(df_long$Gene))  # Apply all gene labels for x-axis
figure
ggsave(filename = "new_heat_map_red.png", plot = figure, width=169, units = "mm")
#==================
library(tidyr)
library(ggplot2)
library(viridis)
setwd("/Users/matt/Documents/GitHub/mhc/scripts/visualizations/heat_map/")
revio <- read.table("revio_gene_coverage_depth.tsv", header = TRUE, sep = "\t", stringsAsFactors = FALSE)
prom <- read.table("promethion_gene_coverage_depth.tsv", header = TRUE, sep = "\t", stringsAsFactors = FALSE)
sample_order <- rev(colnames(revio)[-1])
# Helper to reshape one table
reshape_for_heatmap <- function(data, platform_name) {
rownames(data) <- make.unique(data[, 1])
gene_order <- rownames(data)
data <- data[, -1]
mat <- t(as.matrix(data))
mat[mat > 50] <- 50
df <- as.data.frame(mat)
df$Sample <- rownames(mat)
df_long <- pivot_longer(df, cols = -Sample, names_to = "Gene", values_to = "Depth")
df_long$Platform <- platform_name
df_long$Depth <- as.numeric(df_long$Depth)
df_long$Sample <- factor(df_long$Sample, levels = sample_order)  # Preserve order here
df_long$Gene <- factor(df_long$Gene, levels = gene_order)        # (Optional) gene order too
df_long
}
# Combine into one long dataframe
df_long <- rbind(
reshape_for_heatmap(revio, "Revio"),
reshape_for_heatmap(prom, "PromethION")
)
df_long$Platform <- factor(df_long$Platform, levels = c("Revio", "PromethION"))
# Plot
figure2 <- ggplot(df_long, aes(x = Gene, y = Sample, fill = Depth)) +
geom_tile(color = "white") +
scale_fill_viridis_c(option = "viridis", direction = -1) +
theme_minimal() +
facet_wrap(~ Platform, ncol = 1, labeller = as_labeller(c(Revio = "PacBio Revio", PromethION = "ONT PromethION"))) +
theme(
axis.text.x = element_text(size = 5, angle = 90, hjust = 1, vjust = 0.5),
axis.text.y = element_text(size = 4.5),
strip.text = element_text(size = 8),
legend.title = element_text(size = 6),
legend.text = element_text(size = 7),
legend.key.height = unit(0.25, "cm"),
legend.key.width = unit(2, "cm"),
legend.position = "top"
) +
labs(
x = "MHC Genes",
y = "Samples",
fill = "Mean Coverage Depth"
)
figure2
ggsave(filename = "combined_heat_map.png", plot = figure2)
ggsave(filename = "combined_heat_map.pdf", plot = figure2)
