process_data <- function(data) {
data %>%
mutate(window = floor(base / 100) * 100 + 50) %>% # Create windows centered at midpoints
group_by(window) %>%
summarize(
mean_depth = mean(mean_depth),
std_depth = mean(std_depth)
) %>%
rename(base = window) %>%
filter(base >= 29715000 & base <= 30019999) %>%  # MHC Class I Part 1
mutate(group = floor(base / 1000) * 1000)
}
# Process data for both datasets
data_filtered_revio <- process_data(hla_per_base_revio)
data_filtered_promethion <- process_data(hla_per_base_promethion)
# Create the plots
plot1 <- ggplot(data_filtered_revio, aes(x = group, y = mean_depth)) +
geom_bar(stat = "summary", fun = "mean", width = 1000, fill = "royalblue") +
xlab("") +  # Remove x-axis label for the top plot
ylab("Mean Coverage Depth (RevIO)") +
theme(
panel.background = element_blank(),
panel.border = element_blank(),
axis.line = element_line(colour = "black", size = 1),
axis.text.x = element_blank(),  # Remove x-axis text for the top plot
axis.text.y = element_text(size = 12),
axis.title.y = element_text(size = 12, face = "bold")
) +
scale_y_continuous(limits = c(-220, max(data_filtered_revio$mean_depth, data_filtered_promethion$mean_depth)))
plot2 <- ggplot(data_filtered_promethion, aes(x = group, y = mean_depth)) +
geom_bar(stat = "summary", fun = "mean", width = 1000, fill = "red") +
xlab("Position on Chromosome 6 (Mb)") +
ylab("Mean Coverage Depth (PromethION)") +
theme(
panel.background = element_blank(),
panel.border = element_blank(),
axis.line = element_line(colour = "black", size = 1),
axis.text.x = element_text(size = 12, angle = 45, hjust = 1),
axis.text.y = element_text(size = 12),
axis.title.y = element_text(size = 12, face = "bold")
) +
scale_x_continuous(
labels = function(x) sprintf("%.2f", x / 1e6),
breaks = pretty(data_filtered_promethion$base, n = 10)
) +
scale_y_continuous(limits = c(-220, max(data_filtered_revio$mean_depth, data_filtered_promethion$mean_depth)))
# Combine plots using cowplot
figure <- plot_grid(plot1, plot2, align = "v", ncol = 1, rel_heights = c(1, 1))
# Add gene labels at the bottom
gene_labels <- data.frame(
x = c(29792734.5, 29945395.5, 29725651, 29801419.5, 29829045.5, 29889116.5, 29927845, 29957582.5, 30008072),
y = -250,  # Adjust y-coordinate for label placement
label = c("HLA-V", "HLA-A", "HLA-F", "HLA-P", "HLA-G", "HLA-H", "HLA-K", "HLA-W", "HLA-J")
)
figure <- figure + draw_label(
label = gene_labels$label,
x = gene_labels$x,
y = gene_labels$y,
vjust = 0,
size = 3
)
# Display the figure
print(figure)
library(tidyverse)
library(ggplot2)
library(dplyr)
library(cowplot)
setwd("/Users/matt/Documents/GitHub/mhc/scripts/visualizations/")
# Load data
hla_per_base_revio <- readRDS("/Users/matt/Documents/GitHub/mhc/clean_data/revio_mean_std_depth.rds")
hla_per_base_promethion <- readRDS("/Users/matt/Documents/GitHub/mhc/clean_data/promethion_mean_std_depth.rds")
# Function to process data for plotting
process_data <- function(data) {
data %>%
mutate(window = floor(base / 100) * 100 + 50) %>% # Create windows centered at midpoints
group_by(window) %>%
summarize(
mean_depth = mean(mean_depth),
std_depth = mean(std_depth)
) %>%
rename(base = window) %>%
filter(base >= 29715000 & base <= 30019999) %>%  # MHC Class I Part 1
library(tidyverse)
library(ggplot2)
library(dplyr)
library(cowplot)
setwd("/Users/matt/Documents/GitHub/mhc/scripts/visualizations/")
# Load data
hla_per_base_revio <- readRDS("/Users/matt/Documents/GitHub/mhc/clean_data/revio_mean_std_depth.rds")
hla_per_base_promethion <- readRDS("/Users/matt/Documents/GitHub/mhc/clean_data/promethion_mean_std_depth.rds")
# Function to process data for plotting
process_data <- function(data) {
data %>%
mutate(window = floor(base / 100) * 100 + 50) %>% # Create windows centered at midpoints
group_by(window) %>%
summarize(
mean_depth = mean(mean_depth),
std_depth = mean(std_depth)
) %>%
rename(base = window) %>%
filter(base >= 29715000 & base <= 30019999) %>%  # MHC Class I Part 1
library(tidyverse)
library(ggplot2)
library(dplyr)
library(cowplot)
setwd("/Users/matt/Documents/GitHub/mhc/scripts/visualizations/")
# Load data
hla_per_base_revio <- readRDS("/Users/matt/Documents/GitHub/mhc/clean_data/revio_mean_std_depth.rds")
hla_per_base_promethion <- readRDS("/Users/matt/Documents/GitHub/mhc/clean_data/promethion_mean_std_depth.rds")
# Function to process data for plotting
process_data <- function(data) {
data %>%
mutate(window = floor(base / 100) * 100 + 50) %>% # Create windows centered at midpoints
group_by(window) %>%
summarize(
mean_depth = mean(mean_depth),
std_depth = mean(std_depth)
) %>%
rename(base = window) %>%
filter(base >= 29715000 & base <= 30019999) %>%  # MHC Class I Part 1
library(tidyverse)
library(ggplot2)
library(dplyr)
library(cowplot)
setwd("/Users/matt/Documents/GitHub/mhc/scripts/visualizations/")
# Load data
hla_per_base_revio <- readRDS("/Users/matt/Documents/GitHub/mhc/clean_data/revio_mean_std_depth.rds")
hla_per_base_promethion <- readRDS("/Users/matt/Documents/GitHub/mhc/clean_data/promethion_mean_std_depth.rds")
# Function to process data for plotting
process_data <- function(data) {
data %>%
mutate(window = floor(base / 100) * 100 + 50) %>% # Create windows centered at midpoints
group_by(window) %>%
summarize(
mean_depth = mean(mean_depth),
std_depth = mean(std_depth)
) %>%
rename(base = window) %>%
filter(base >= 29715000 & base <= 30019999) %>%  # MHC Class I Part 1
library(tidyverse)
library(ggplot2)
library(dplyr)
library(cowplot)
setwd("/Users/matt/Documents/GitHub/mhc/scripts/visualizations/")
# Load data
hla_per_base_revio <- readRDS("/Users/matt/Documents/GitHub/mhc/clean_data/revio_mean_std_depth.rds")
hla_per_base_promethion <- readRDS("/Users/matt/Documents/GitHub/mhc/clean_data/promethion_mean_std_depth.rds")
# Function to process data for plotting
process_data <- function(data) {
data %>%
mutate(window = floor(base / 100) * 100 + 50) %>% # Create windows centered at midpoints
group_by(window) %>%
summarize(
mean_depth = mean(mean_depth),
std_depth = mean(std_depth)
) %>%
rename(base = window) %>%
filter(base >= 29715000 & base <= 30019999) %>%  # MHC Class I Part 1
mutate(group = floor(base / 1000) * 1000)
}
# Process data for both datasets
data_filtered_revio <- process_data(hla_per_base_revio)
data_filtered_promethion <- process_data(hla_per_base_promethion)
# Create the plots
plot1 <- ggplot(data_filtered_revio, aes(x = group, y = mean_depth)) +
geom_bar(stat = "summary", fun = "mean", width = 1000, fill = "royalblue") +
xlab("") +  # Remove x-axis label for the top plot
library(tidyverse)
library(ggplot2)
library(dplyr)
library(cowplot)
setwd("/Users/matt/Documents/GitHub/mhc/scripts/visualizations/")
# Load data
hla_per_base_revio <- readRDS("/Users/matt/Documents/GitHub/mhc/clean_data/revio_mean_std_depth.rds")
hla_per_base_promethion <- readRDS("/Users/matt/Documents/GitHub/mhc/clean_data/promethion_mean_std_depth.rds")
# Function to process data for plotting
process_data <- function(data) {
data %>%
mutate(window = floor(base / 100) * 100 + 50) %>% # Create windows centered at midpoints
group_by(window) %>%
summarize(
mean_depth = mean(mean_depth),
std_depth = mean(std_depth)
) %>%
rename(base = window) %>%
filter(base >= 29715000 & base <= 30019999) %>%  # MHC Class I Part 1
mutate(group = floor(base / 1000) * 1000)
}
# Process data for both datasets
data_filtered_revio <- process_data(hla_per_base_revio)
data_filtered_promethion <- process_data(hla_per_base_promethion)
# Create the plots
plot1 <- ggplot(data_filtered_revio, aes(x = group, y = mean_depth)) +
geom_bar(stat = "summary", fun = "mean", width = 1000, fill = "royalblue") +
labs(x = "") +  # Remove x-axis label for the top plot
library(tidyverse)
library(ggplot2)
library(dplyr)
library(cowplot)
setwd("/Users/matt/Documents/GitHub/mhc/scripts/visualizations/")
# Load data
hla_per_base_revio <- readRDS("/Users/matt/Documents/GitHub/mhc/clean_data/revio_mean_std_depth.rds")
hla_per_base_promethion <- readRDS("/Users/matt/Documents/GitHub/mhc/clean_data/promethion_mean_std_depth.rds")
# Function to process data for plotting
process_data <- function(data) {
data %>%
mutate(window = floor(base / 100) * 100 + 50) %>% # Create windows centered at midpoints
group_by(window) %>%
summarize(
mean_depth = mean(mean_depth),
std_depth = mean(std_depth)
) %>%
rename(base = window) %>%
filter(base >= 29715000 & base <= 30019999) %>%  # MHC Class I Part 1
mutate(group = floor(base / 1000) * 1000)
}
# Process data for both datasets
data_filtered_revio <- process_data(hla_per_base_revio)
data_filtered_promethion <- process_data(hla_per_base_promethion)
# Create the plots
plot1 <- ggplot(data_filtered_revio, aes(x = group, y = mean_depth)) +
geom_bar(stat = "summary", fun = "mean", width = 1000, fill = "royalblue") +
labs(x = "") +  # Remove x-axis label for the top plot
library(tidyverse)
library(ggplot2)
library(dplyr)
library(cowplot)
setwd("/Users/matt/Documents/GitHub/mhc/scripts/visualizations/")
# Load data
hla_per_base_revio <- readRDS("/Users/matt/Documents/GitHub/mhc/clean_data/revio_mean_std_depth.rds")
hla_per_base_promethion <- readRDS("/Users/matt/Documents/GitHub/mhc/clean_data/promethion_mean_std_depth.rds")
# Function to process data for plotting
process_data <- function(data) {
data %>%
mutate(window = floor(base / 100) * 100 + 50) %>% # Create windows centered at midpoints
group_by(window) %>%
summarize(
mean_depth = mean(mean_depth),
std_depth = mean(std_depth)
) %>%
rename(base = window) %>%
filter(base >= 29715000 & base <= 30019999) %>%  # MHC Class I Part 1
mutate(group = floor(base / 1000) * 1000)
}
# Process data for both datasets
data_filtered_revio <- process_data(hla_per_base_revio)
data_filtered_promethion <- process_data(hla_per_base_promethion)
# Create the plots
plot1 <- ggplot(data_filtered_revio, aes(x = group, y = mean_depth)) +
geom_bar(stat = "summary", fun = "mean", width = 1000, fill = "royalblue") +
ylab("Mean Coverage Depth (RevIO)") +
theme(
panel.background = element_blank(),
panel.border = element_blank(),
axis.line = element_line(colour = "black", size = 1),
axis.text.x = element_blank(),  # Remove x-axis text for the top plot
library(tidyverse)
library(ggplot2)
library(dplyr)
library(cowplot)
setwd("/Users/matt/Documents/GitHub/mhc/scripts/visualizations/")
# Load data
hla_per_base_revio <- readRDS("/Users/matt/Documents/GitHub/mhc/clean_data/revio_mean_std_depth.rds")
hla_per_base_promethion <- readRDS("/Users/matt/Documents/GitHub/mhc/clean_data/promethion_mean_std_depth.rds")
# Function to process data for plotting
process_data <- function(data) {
data %>%
mutate(window = floor(base / 100) * 100 + 50) %>% # Create windows centered at midpoints
group_by(window) %>%
summarize(
mean_depth = mean(mean_depth),
std_depth = mean(std_depth)
) %>%
rename(base = window) %>%
filter(base >= 29715000 & base <= 30019999) %>%  # MHC Class I Part 1
mutate(group = floor(base / 1000) * 1000)
}
# Process data for both datasets
data_filtered_revio <- process_data(hla_per_base_revio)
data_filtered_promethion <- process_data(hla_per_base_promethion)
# Create the plots
plot1 <- ggplot(data_filtered_revio, aes(x = group, y = mean_depth)) +
geom_bar(stat = "summary", fun = "mean", width = 1000, fill = "royalblue") +
ylab("Mean Coverage Depth (RevIO)") +
theme(
panel.background = element_blank(),
panel.border = element_blank(),
axis.line = element_line(colour = "black", size = 1),
axis.text.x = element_blank(),  # Remove x-axis text for the top plot
library(tidyverse)
library(ggplot2)
library(dplyr)
library(cowplot)
setwd("/Users/matt/Documents/GitHub/mhc/scripts/visualizations/")
# Load data
hla_per_base_revio <- readRDS("/Users/matt/Documents/GitHub/mhc/clean_data/revio_mean_std_depth.rds")
hla_per_base_promethion <- readRDS("/Users/matt/Documents/GitHub/mhc/clean_data/promethion_mean_std_depth.rds")
# Function to process data for plotting
process_data <- function(data) {
data %>%
mutate(window = floor(base / 100) * 100 + 50) %>% # Create windows centered at midpoints
group_by(window) %>%
summarize(
mean_depth = mean(mean_depth),
std_depth = mean(std_depth)
) %>%
rename(base = window) %>%
filter(base >= 29715000 & base <= 30019999) %>%  # MHC Class I Part 1
mutate(group = floor(base / 1000) * 1000)
}
# Process data for both datasets
data_filtered_revio <- process_data(hla_per_base_revio)
data_filtered_promethion <- process_data(hla_per_base_promethion)
# Create the plots
plot1 <- ggplot(data_filtered_revio, aes(x = group, y = mean_depth)) +
geom_bar(stat = "summary", fun = "mean", width = 1000, fill = "royalblue") +
ylab("Mean Coverage Depth (RevIO)") +
theme(
panel.background = element_blank(),
panel.border = element_blank(),
axis.line = element_line(color = "black", size = 1),
axis.text.x = element_blank(),  # Remove x-axis text for the top plot
library(tidyverse)
library(ggplot2)
library(dplyr)
library(cowplot)
setwd("/Users/matt/Documents/GitHub/mhc/scripts/visualizations/")
# Load data
hla_per_base_revio <- readRDS("/Users/matt/Documents/GitHub/mhc/clean_data/revio_mean_std_depth.rds")
hla_per_base_promethion <- readRDS("/Users/matt/Documents/GitHub/mhc/clean_data/promethion_mean_std_depth.rds")
# Function to process data for plotting
process_data <- function(data) {
data %>%
mutate(window = floor(base / 100) * 100 + 50) %>% # Create windows centered at midpoints
group_by(window) %>%
summarize(
mean_depth = mean(mean_depth),
std_depth = mean(std_depth)
) %>%
rename(base = window) %>%
filter(base >= 29715000 & base <= 30019999) %>%  # MHC Class I Part 1
mutate(group = floor(base / 1000) * 1000)
}
# Process data for both datasets
data_filtered_revio <- process_data(hla_per_base_revio)
data_filtered_promethion <- process_data(hla_per_base_promethion)
# Create the plots
plot1 <- ggplot(data_filtered_revio, aes(x = group, y = mean_depth)) +
geom_bar(stat = "summary", fun = "mean", width = 1000, fill = "royalblue") +
ylab("Mean Coverage Depth (RevIO)") +
theme(
panel.background = element_blank(),
panel.border = element_blank(),
axis.line = element_line(color = "black", size = 1),
axis.text.x = element_blank(),  # Remove x-axis text for the top plot
library(tidyverse)
library(ggplot2)
library(dplyr)
library(cowplot)
setwd("/Users/matt/Documents/GitHub/mhc/scripts/visualizations/")
# Load data
hla_per_base_revio <- readRDS("/Users/matt/Documents/GitHub/mhc/clean_data/revio_mean_std_depth.rds")
hla_per_base_promethion <- readRDS("/Users/matt/Documents/GitHub/mhc/clean_data/promethion_mean_std_depth.rds")
# Function to process data for plotting
process_data <- function(data) {
data %>%
mutate(window = floor(base / 100) * 100 + 50) %>% # Create windows centered at midpoints
group_by(window) %>%
summarize(
mean_depth = mean(mean_depth),
std_depth = mean(std_depth)
) %>%
rename(base = window) %>%
filter(base >= 29715000 & base <= 30019999) %>%  # MHC Class I Part 1
mutate(group = floor(base / 1000) * 1000)
}
# Process data for both datasets
data_filtered_revio <- process_data(hla_per_base_revio)
data_filtered_promethion <- process_data(hla_per_base_promethion)
# Create the plots
plot1 <- ggplot(data_filtered_revio, aes(x = group, y = mean_depth)) +
geom_bar(stat = "summary", fun = "mean", width = 1000, fill = "royalblue") +
ylab("Mean Coverage Depth (RevIO)") +
theme(
panel.background = element_blank(),
panel.border = element_blank(),
axis.line = element_line(color = "black", size = 1),
axis.text.x = element_blank(),  # Remove x-axis text for the top plot
library(tidyverse)
library(ggplot2)
library(dplyr)
library(cowplot)
setwd("/Users/matt/Documents/GitHub/mhc/scripts/visualizations/")
# Load data
hla_per_base_revio <- readRDS("/Users/matt/Documents/GitHub/mhc/clean_data/revio_mean_std_depth.rds")
hla_per_base_promethion <- readRDS("/Users/matt/Documents/GitHub/mhc/clean_data/promethion_mean_std_depth.rds")
# Function to process data for plotting
process_data <- function(data) {
data %>%
mutate(window = floor(base / 100) * 100 + 50) %>% # Create windows centered at midpoints
group_by(window) %>%
summarize(
mean_depth = mean(mean_depth),
std_depth = mean(std_depth)
) %>%
rename(base = window) %>%
filter(base >= 29715000 & base <= 30019999) %>%  # MHC Class I Part 1
mutate(group = floor(base / 1000) * 1000)
}
# Process data for both datasets
data_filtered_revio <- process_data(hla_per_base_revio)
data_filtered_promethion <- process_data(hla_per_base_promethion)
# Create the plots
plot1 <- ggplot(data_filtered_revio, aes(x = group, y = mean_depth)) +
geom_bar(stat = "summary", fun = "mean", width = 1000, fill = "royalblue") +
ylab("Mean Coverage Depth (RevIO)") +
theme(
panel.background = element_blank(),
panel.border = element_blank(),
axis.line = element_line(color = "black", size = 1),
axis.text.x = element_blank(),  # Remove x-axis text for the top plot
library(tidyverse)
library(ggplot2)
library(cowplot)
# Load data
hla_per_base_revio <- readRDS("/Users/matt/Documents/GitHub/mhc/clean_data/revio_mean_std_depth.rds")
hla_per_base_promethion <- readRDS("/Users/matt/Documents/GitHub/mhc/clean_data/promethion_mean_std_depth.rds")
# Process data (simplified)
plot_data <- function(data, fill_color) {
data %>%
mutate(window = floor(base / 100) * 100 + 50) %>%
group_by(window) %>%
summarize(mean_depth = mean(mean_depth)) %>%
mutate(group = floor(base / 1000) * 1000) %>%
ggplot(aes(x = group, y = mean_depth)) +
geom_bar(stat = "identity", width = 1000, fill = fill_color) +
theme_minimal()
}
# Create plots
plot1 <- plot_data(hla_per_base_revio, "royalblue") +
ylab("Mean Coverage Depth (RevIO)") +
theme(axis.text.x = element_blank())
library(tidyverse)
library(ggplot2)
library(cowplot)
# Load data
hla_per_base_revio <- readRDS("/Users/matt/Documents/GitHub/mhc/clean_data/revio_mean_std_depth.rds")
hla_per_base_promethion <- readRDS("/Users/matt/Documents/GitHub/mhc/clean_data/promethion_mean_std_depth.rds")
# Process data (simplified)
plot_data <- function(data, fill_color) {
data %>%
mutate(window = floor(base / 100) * 100 + 50) %>%
group_by(window) %>%
summarize(mean_depth = mean(mean_depth)) %>%
mutate(group = floor(base / 1000) * 1000) %>%
ggplot(aes(x = group, y = mean_depth)) +
geom_bar(stat = "identity", width = 1000, fill = fill_color) +
theme_minimal()
}
# Create plots
plot1 <- plot_data(hla_per_base_revio, "royalblue") +
ylab("Mean Coverage Depth (RevIO)") +
theme(axis.text.x = element_blank())
library(tidyverse)
library(ggplot2)
library(cowplot)
# Load data
hla_per_base_revio <- readRDS("/Users/matt/Documents/GitHub/mhc/clean_data/revio_mean_std_depth.rds")
hla_per_base_promethion <- readRDS("/Users/matt/Documents/GitHub/mhc/clean_data/promethion_mean_std_depth.rds")
# Process data
process_data <- function(data) {
data %>%
mutate(window = floor(base / 100) * 100 + 50) %>% # Create windows centered at midpoints
group_by(window) %>%
summarize(mean_depth = mean(mean_depth)) %>%
mutate(group = floor(window / 1000) * 1000)
}
# Prepare data for plotting
data_filtered_revio <- process_data(hla_per_base_revio)
data_filtered_promethion <- process_data(hla_per_base_promethion)
# Create plots
plot1 <- ggplot(data_filtered_revio, aes(x = group, y = mean_depth)) +
geom_bar(stat = "identity", width = 1000, fill = "royalblue") +
ylab("Mean Coverage Depth (RevIO)") +
theme_minimal() +
theme(axis.text.x = element_blank())
plot2 <- ggplot(data_filtered_promethion, aes(x = group, y = mean_depth)) +
geom_bar(stat = "identity", width = 1000, fill = "red") +
xlab("Position on Chromosome 6 (Mb)") +
ylab("Mean Coverage Depth (PromethION)") +
theme_minimal() +
scale_x_continuous(
labels = function(x) sprintf("%.2f", x / 1e6),
breaks = seq(29.7, 30.0, by = 0.1)
)
# Combine plots
figure <- plot_grid(plot1, plot2, align = "v", ncol = 1)
# Add gene labels
gene_labels <- data.frame(
x = c(29792734.5, 29945395.5, 29725651, 29801419.5, 29829045.5, 29889116.5, 29927845, 29957582.5, 30008072),
y = -250,
label = c("HLA-V", "HLA-A", "HLA-F", "HLA-P", "HLA-G", "HLA-H", "HLA-K", "HLA-W", "HLA-J")
)
figure <- figure + draw_label(
label = gene_labels$label,
x = gene_labels$x,
y = gene_labels$y,
vjust = 0,
size = 3
)
# Display the figure
print(figure)
